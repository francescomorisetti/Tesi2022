* squared_me.F
* this file is part of the process {MU, MU} -> {MM, MM}
* generated by WriteSquaredME 24 Jul 2006 0:59

#include "prefix.h"

	subroutine uusquared_me(tree, loop, sqrtS,
     +    Hel1from, Hel1to, Hel2from, Hel2to, Hel3from, Hel3to,
     +    Hel4from, Hel4to, reset)
	implicit integer (j)
	implicit character (a-i,k-z)

	double precision tree, loop
	double precision sqrtS
	integer Hel1from, Hel1to, Hel2from, Hel2to, Hel3from, Hel3to
	integer Hel4from, Hel4to
	logical reset

#include "vars.h"

	double precision MomSquare
	external MomSquare

	double complex c, m
	integer Cptr, Dptr
	double precision prevS
	save prevS
	data prevS /-1/

***
**	S = sqrtS**2
**	T = MomSquare(1,9)
**	U = MomSquare(1,13)
**

	
c	if(reset .or. S .ne. prevS) then
	  call setcachelast(Ccache, 0)
	  call setcachelast(Dcache, 0)
	  call uuabbr_s
c	  reset = .FALSE.
	  prevS = S
c	endif
	Cptr = getcachelast(Ccache)
	Dptr = getcachelast(Dcache)
c	print*,reset

c	print*,Cptr,Dptr
c	stop
	
	call uuabbr_angle1
	call uuabbr_angle2
	call uuabbr_angle3
	call uuabbr_angle4

	tree = 0
	loop = 0

	do 1 Hel1 = Hel1from, Hel1to
	do 1 Hel2 = Hel2from, Hel2to
	do 1 Hel3 = Hel3from, Hel3to
	do 1 Hel4 = Hel4from, Hel4to

	call uuabbr_hel1
	call uuabbr_hel2
	call uuabbr_hel3
	call uuabbr_hel4
	call uuabbr_hel5

	do j7 = 1, 4
	Ctree(j7) = 0
	enddo

	do j8 = 1, 48
	Cloop(j8) = 0
	enddo

	call uuborn
	call uusself	
	call uuvert
	call uuboxa
	call uuboxb
	call uucts
	
	do j9 = 1, 4
	c = dconjg(Ctree(j9))

	m = 0
	do j7 = 1, 4
	m = m + Ctree(j7)*MatF(j7,j9)
	enddo
	tree = tree + dble(c*m)

	m = 0
	do j8 = 1, 48
	m = m + Cloop(j8)*MatF(j8,j9)
	enddo
	loop = loop + 2*dble(c*m)

	enddo

c	print*,MatF
	
c	do j8=1,48
c	   print*,j8,Cloop(j8)
c	enddo
	
 1	continue

	call setcachelast(Ccache, Cptr)
	call setcachelast(Dcache, Dptr)
	end

